// INTERNATIONALIZATION
const translations = {
    pt: {
        title: "O IMPOSTOR",
        subtitle: "Jogo de deduÃ§Ã£o social por palavras",
        chooseMode: "ğŸ® Escolha o Modo",
        localMode: "MODO LOCAL",
        localModeDesc: "Um Ãºnico dispositivo. Passe o celular entre os jogadores. Ideal para jogar presencialmente.",
        onlineMode: "MODO ONLINE",
        onlineModeDesc: "Cada jogador usa seu prÃ³prio dispositivo. Conecte-se na mesma sala. Ideal para jogar Ã  distÃ¢ncia.",
        players: "ğŸ‘¥ Jogadores",
        maxImpostors: "ğŸ­ MÃ¡x. Impostores",
        impostorInfo: "Pode ter de 1 atÃ© o mÃ¡ximo selecionado",
        impostorMode: "ğŸ”® Modo Impostor",
        impostorKnows: "Impostor sabe que Ã© impostor",
        impostorModeInfo: "Se desativado, impostor recebe palavra similar",
        maxPoints: "ğŸ† PontuaÃ§Ã£o MÃ¡xima",
        maxPointsInfo: "Deixe vazio para jogar sem limite de pontos",
        categories: "ğŸ“‚ Categorias",
        allCategories: "Todas as categorias",
        names: "ğŸ“ Nomes",
        startGame: "ğŸ® INICIAR JOGO",
        howToPlay: "ğŸ“– Como Jogar",
        instructions: "<strong style='color:var(--text)'>1.</strong> Cada jogador vÃª sua palavra em segredo<br><strong style='color:var(--text)'>2.</strong> Todos recebem a mesma palavra, exceto os <span style='color:var(--accent)'>IMPOSTORES</span><br><strong style='color:var(--text)'>3.</strong> Cada um fala uma palavra relacionada<br><strong style='color:var(--text)'>4.</strong> A qualquer momento, votem em quem acham que Ã© impostor<br><strong style='color:var(--text)'>5.</strong> Continue atÃ© descobrir todos os impostores<br><strong style='color:var(--text)'>6.</strong> Pontue os jogadores ao final!",
        round: "RODADA",
        pickUpPhone: "Pegue o celular e veja sua palavra",
        progress: "ğŸ“‹ Progresso",
        seeWord: "ğŸ‘ï¸ VER MINHA PALAVRA",
        yourMission: "SUA MISSÃƒO",
        memorizePass: "Memorize e passe o celular",
        gotItNext: "âœ“ ENTENDI, PRÃ“XIMO",
        playersLabel: "Jogadores",
        impostorsLabel: "Impostores",
        timeToPlay: "ğŸ­ Hora de Jogar!",
        playInstructions: "Cada um fala uma palavra relacionada. Quando suspeitarem de alguÃ©m, votem!",
        chooseImpostor: "ğŸ—³ï¸ ESCOLHER IMPOSTOR",
        seeRanking: "ğŸ† VER RANKING",
        restartGame: "REINICIAR JOGO",
        back: "â† VOLTAR",
        installPrompt: "Instale o app para jogar offline!",
        install: "INSTALAR",
        player: "Jogador",
        impostor: "ğŸ­ IMPOSTOR",
        whoIsImpostor: "ğŸ—³ï¸ QUEM Ã‰ O IMPOSTOR?",
        chooseWhoYouThink: "Escolha quem vocÃªs acham que Ã© o impostor:",
        cancel: "CANCELAR",
        correct: "ACERTARAM!",
        wrong: "ERRARAM!",
        wasImpostor: "era um impostor!",
        wasInnocent: "era inocente!",
        remainingImpostors: "Ainda hÃ¡ {n} impostor(es) restante(s)!",
        hiddenImpostors: "Ainda hÃ¡ {n} impostor(es) escondido(s)!",
        adjustPoints: "AJUSTAR PONTOS",
        roundEnd: "ğŸ FIM DA RODADA",
        impostorsWere: "Os impostores eram:",
        impostorWas: "O impostor era:",
        word: "Palavra:",
        finalScore: "PONTUAÃ‡ÃƒO FINAL",
        nextRound: "PRÃ“XIMA RODADA",
        close: "FECHAR",
        continueVoting: "CONTINUAR VOTANDO",
        backToGame: "VOLTAR AO JOGO",
        seeRoundSummary: "VER RESUMO DA RODADA",
        restartConfirm: "âš ï¸ REINICIAR?",
        restartWarning: "Isso vai apagar todas as pontuaÃ§Ãµes e reiniciar o jogo do zero.",
        yesRestart: "SIM, REINICIAR TUDO",
        gameRestarted: "Jogo reiniciado",
        gameRestored: "Jogo restaurado",
        startsTalking: "comeÃ§a falando",
        newRound: "Rodada",
        settings: "âš™ï¸ CONFIGURAÃ‡Ã•ES",
        language: "Idioma",
        saveSettings: "SALVAR",
        impostorWords: "Palavras dos impostores",
        impostorWins: "O IMPOSTOR VENCEU!",
        eliminatedWrong: "VocÃªs eliminaram os jogadores errados!",
        // Online mode
        yourName: "ğŸ‘¤ Seu Nome",
        createRoom: "ğŸ  CRIAR SALA",
        joinRoom: "ğŸšª ENTRAR EM SALA",
        roomSettings: "CONFIGURAR SALA",
        roomLanguage: "ğŸŒ Idioma da Sala",
        roomCode: "ğŸ”‘ CÃ³digo da Sala",
        enter: "ğŸšª ENTRAR",
        lobby: "SALA DE ESPERA",
        shareCode: "Compartilhe o cÃ³digo ou QR Code com seus amigos",
        playersInRoom: "Jogadores na Sala",
        waitingHost: "Aguardando o host iniciar",
        leaveRoom: "SAIR DA SALA",
        host: "HOST",
        you: "VOCÃŠ",
        hideWord: "ğŸ™ˆ ESCONDER PALAVRA",
        showWord: "ğŸ‘ï¸ MOSTRAR PALAVRA",
        wordHidden: "Palavra escondida",
        startVoting: "ğŸ—³ï¸ INICIAR VOTAÃ‡ÃƒO",
        voting: "ğŸ—³ï¸ VOTAÃ‡ÃƒO",
        waitingVotes: "Aguardando votos",
        result: "ğŸ“Š RESULTADO",
        ready: "âœ“ PRONTO",
        waitingPlayers: "Aguardando jogadores",
        gameOver: "ğŸ‰ FIM DE JOGO",
        reachedPoints: "AlcanÃ§ou a pontuaÃ§Ã£o mÃ¡xima!",
        finalRanking: "ğŸ† RANKING FINAL",
        playAgain: "ğŸ”„ JOGAR NOVAMENTE",
        minPlayers: "MÃ­nimo 3 jogadores para iniciar",
        connecting: "Conectando...",
        connected: "Conectado",
        disconnected: "Desconectado",
        roomNotFound: "Sala nÃ£o encontrada",
        roomFull: "Sala cheia",
        nameRequired: "Digite seu nome",
        voted: "Votou",
        eliminated: "Eliminado",
        surviving: "Sobreviveu",
        firstRoundCatch: "Descoberto na 1Âª rodada",
        pointsGained: "+{n} ponto(s)",
        pointsLost: "-{n} ponto(s)",
        selectCategories: "Selecione pelo menos uma categoria"
    },
    en: {
        title: "THE IMPOSTOR",
        subtitle: "Social deduction word game",
        chooseMode: "ğŸ® Choose Mode",
        localMode: "LOCAL MODE",
        localModeDesc: "Single device. Pass the phone between players. Ideal for playing in person.",
        onlineMode: "ONLINE MODE",
        onlineModeDesc: "Each player uses their own device. Connect to the same room. Ideal for playing remotely.",
        players: "ğŸ‘¥ Players",
        maxImpostors: "ğŸ­ Max. Impostors",
        impostorInfo: "Can have from 1 up to the selected maximum",
        impostorMode: "ğŸ”® Impostor Mode",
        impostorKnows: "Impostor knows they are the impostor",
        impostorModeInfo: "If disabled, impostor receives a similar word",
        maxPoints: "ğŸ† Maximum Points",
        maxPointsInfo: "Leave empty to play without point limit",
        categories: "ğŸ“‚ Categories",
        allCategories: "All categories",
        names: "ğŸ“ Names",
        startGame: "ğŸ® START GAME",
        howToPlay: "ğŸ“– How to Play",
        instructions: "<strong style='color:var(--text)'>1.</strong> Each player sees their word secretly<br><strong style='color:var(--text)'>2.</strong> Everyone gets the same word, except the <span style='color:var(--accent)'>IMPOSTORS</span><br><strong style='color:var(--text)'>3.</strong> Each person says a related word<br><strong style='color:var(--text)'>4.</strong> At any time, vote on who you think is the impostor<br><strong style='color:var(--text)'>5.</strong> Continue until you find all impostors<br><strong style='color:var(--text)'>6.</strong> Score the players at the end!",
        round: "ROUND",
        pickUpPhone: "Pick up the phone and see your word",
        progress: "ğŸ“‹ Progress",
        seeWord: "ğŸ‘ï¸ SEE MY WORD",
        yourMission: "YOUR MISSION",
        memorizePass: "Memorize and pass the phone",
        gotItNext: "âœ“ GOT IT, NEXT",
        playersLabel: "Players",
        impostorsLabel: "Impostors",
        timeToPlay: "ğŸ­ Time to Play!",
        playInstructions: "Each person says a related word. When you suspect someone, vote!",
        chooseImpostor: "ğŸ—³ï¸ CHOOSE IMPOSTOR",
        seeRanking: "ğŸ† SEE RANKING",
        restartGame: "RESTART GAME",
        back: "â† BACK",
        installPrompt: "Install the app to play offline!",
        install: "INSTALL",
        player: "Player",
        impostor: "ğŸ­ IMPOSTOR",
        whoIsImpostor: "ğŸ—³ï¸ WHO IS THE IMPOSTOR?",
        chooseWhoYouThink: "Choose who you think is the impostor:",
        cancel: "CANCEL",
        correct: "CORRECT!",
        wrong: "WRONG!",
        wasImpostor: "was an impostor!",
        wasInnocent: "was innocent!",
        remainingImpostors: "There are still {n} impostor(s) remaining!",
        hiddenImpostors: "There are still {n} impostor(s) hidden!",
        adjustPoints: "ADJUST POINTS",
        roundEnd: "ğŸ END OF ROUND",
        impostorsWere: "The impostors were:",
        impostorWas: "The impostor was:",
        word: "Word:",
        finalScore: "FINAL SCORE",
        nextRound: "NEXT ROUND",
        close: "CLOSE",
        continueVoting: "CONTINUE VOTING",
        backToGame: "BACK TO GAME",
        seeRoundSummary: "SEE ROUND SUMMARY",
        restartConfirm: "âš ï¸ RESTART?",
        restartWarning: "This will erase all scores and restart the game from scratch.",
        yesRestart: "YES, RESTART ALL",
        gameRestarted: "Game restarted",
        gameRestored: "Game restored",
        startsTalking: "starts talking",
        newRound: "Round",
        settings: "âš™ï¸ SETTINGS",
        language: "Language",
        saveSettings: "SAVE",
        impostorWords: "Impostor words",
        impostorWins: "THE IMPOSTOR WON!",
        eliminatedWrong: "You eliminated the wrong players!",
        // Online mode
        yourName: "ğŸ‘¤ Your Name",
        createRoom: "ğŸ  CREATE ROOM",
        joinRoom: "ğŸšª JOIN ROOM",
        roomSettings: "ROOM SETTINGS",
        roomLanguage: "ğŸŒ Room Language",
        roomCode: "ğŸ”‘ Room Code",
        enter: "ğŸšª ENTER",
        lobby: "WAITING ROOM",
        shareCode: "Share the code or QR Code with your friends",
        playersInRoom: "Players in Room",
        waitingHost: "Waiting for host to start",
        leaveRoom: "LEAVE ROOM",
        host: "HOST",
        you: "YOU",
        hideWord: "ğŸ™ˆ HIDE WORD",
        showWord: "ğŸ‘ï¸ SHOW WORD",
        wordHidden: "Word hidden",
        startVoting: "ğŸ—³ï¸ START VOTING",
        voting: "ğŸ—³ï¸ VOTING",
        waitingVotes: "Waiting for votes",
        result: "ğŸ“Š RESULT",
        ready: "âœ“ READY",
        waitingPlayers: "Waiting for players",
        gameOver: "ğŸ‰ GAME OVER",
        reachedPoints: "Reached the maximum score!",
        finalRanking: "ğŸ† FINAL RANKING",
        playAgain: "ğŸ”„ PLAY AGAIN",
        minPlayers: "Minimum 3 players to start",
        connecting: "Connecting...",
        connected: "Connected",
        disconnected: "Disconnected",
        roomNotFound: "Room not found",
        roomFull: "Room is full",
        nameRequired: "Enter your name",
        voted: "Voted",
        eliminated: "Eliminated",
        surviving: "Survived",
        firstRoundCatch: "Caught in 1st round",
        pointsGained: "+{n} point(s)",
        pointsLost: "-{n} point(s)",
        selectCategories: "Select at least one category"
    },
    es: {
        title: "EL IMPOSTOR",
        subtitle: "Juego de deducciÃ³n social por palabras",
        chooseMode: "ğŸ® Elige el Modo",
        localMode: "MODO LOCAL",
        localModeDesc: "Un solo dispositivo. Pasa el celular entre los jugadores. Ideal para jugar presencialmente.",
        onlineMode: "MODO ONLINE",
        onlineModeDesc: "Cada jugador usa su propio dispositivo. ConÃ©ctense a la misma sala. Ideal para jugar a distancia.",
        players: "ğŸ‘¥ Jugadores",
        maxImpostors: "ğŸ­ MÃ¡x. Impostores",
        impostorInfo: "Puede haber de 1 hasta el mÃ¡ximo seleccionado",
        impostorMode: "ğŸ”® Modo Impostor",
        impostorKnows: "Impostor sabe que es impostor",
        impostorModeInfo: "Si estÃ¡ desactivado, el impostor recibe una palabra similar",
        maxPoints: "ğŸ† PuntuaciÃ³n MÃ¡xima",
        maxPointsInfo: "Deja vacÃ­o para jugar sin lÃ­mite de puntos",
        categories: "ğŸ“‚ CategorÃ­as",
        allCategories: "Todas las categorÃ­as",
        names: "ğŸ“ Nombres",
        startGame: "ğŸ® INICIAR JUEGO",
        howToPlay: "ğŸ“– CÃ³mo Jugar",
        instructions: "<strong style='color:var(--text)'>1.</strong> Cada jugador ve su palabra en secreto<br><strong style='color:var(--text)'>2.</strong> Todos reciben la misma palabra, excepto los <span style='color:var(--accent)'>IMPOSTORES</span><br><strong style='color:var(--text)'>3.</strong> Cada uno dice una palabra relacionada<br><strong style='color:var(--text)'>4.</strong> En cualquier momento, voten por quiÃ©n creen que es el impostor<br><strong style='color:var(--text)'>5.</strong> ContinÃºen hasta descubrir todos los impostores<br><strong style='color:var(--text)'>6.</strong> Â¡PuntÃºen a los jugadores al final!",
        round: "RONDA",
        pickUpPhone: "Toma el celular y ve tu palabra",
        progress: "ğŸ“‹ Progreso",
        seeWord: "ğŸ‘ï¸ VER MI PALABRA",
        yourMission: "TU MISIÃ“N",
        memorizePass: "Memoriza y pasa el celular",
        gotItNext: "âœ“ ENTENDIDO, SIGUIENTE",
        playersLabel: "Jugadores",
        impostorsLabel: "Impostores",
        timeToPlay: "ğŸ­ Â¡Hora de Jugar!",
        playInstructions: "Cada uno dice una palabra relacionada. Â¡Cuando sospechen de alguien, voten!",
        chooseImpostor: "ğŸ—³ï¸ ELEGIR IMPOSTOR",
        seeRanking: "ğŸ† VER RANKING",
        restartGame: "REINICIAR JUEGO",
        back: "â† VOLVER",
        installPrompt: "Â¡Instala la app para jugar sin conexiÃ³n!",
        install: "INSTALAR",
        player: "Jugador",
        impostor: "ğŸ­ IMPOSTOR",
        whoIsImpostor: "ğŸ—³ï¸ Â¿QUIÃ‰N ES EL IMPOSTOR?",
        chooseWhoYouThink: "Elijan quiÃ©n creen que es el impostor:",
        cancel: "CANCELAR",
        correct: "Â¡ACERTARON!",
        wrong: "Â¡FALLARON!",
        wasImpostor: "Â¡era un impostor!",
        wasInnocent: "Â¡era inocente!",
        remainingImpostors: "Â¡TodavÃ­a hay {n} impostor(es) restante(s)!",
        hiddenImpostors: "Â¡TodavÃ­a hay {n} impostor(es) escondido(s)!",
        adjustPoints: "AJUSTAR PUNTOS",
        roundEnd: "ğŸ FIN DE LA RONDA",
        impostorsWere: "Los impostores eran:",
        impostorWas: "El impostor era:",
        word: "Palabra:",
        finalScore: "PUNTUACIÃ“N FINAL",
        nextRound: "SIGUIENTE RONDA",
        close: "CERRAR",
        continueVoting: "CONTINUAR VOTANDO",
        backToGame: "VOLVER AL JUEGO",
        seeRoundSummary: "VER RESUMEN DE RONDA",
        restartConfirm: "âš ï¸ Â¿REINICIAR?",
        restartWarning: "Esto borrarÃ¡ todas las puntuaciones y reiniciarÃ¡ el juego desde cero.",
        yesRestart: "SÃ, REINICIAR TODO",
        gameRestarted: "Juego reiniciado",
        gameRestored: "Juego restaurado",
        startsTalking: "empieza hablando",
        newRound: "Ronda",
        settings: "âš™ï¸ CONFIGURACIÃ“N",
        language: "Idioma",
        saveSettings: "GUARDAR",
        impostorWords: "Palabras de los impostores",
        impostorWins: "Â¡EL IMPOSTOR GANÃ“!",
        eliminatedWrong: "Â¡Eliminaron a los jugadores equivocados!",
        // Online mode
        yourName: "ğŸ‘¤ Tu Nombre",
        createRoom: "ğŸ  CREAR SALA",
        joinRoom: "ğŸšª UNIRSE A SALA",
        roomSettings: "CONFIGURAR SALA",
        roomLanguage: "ğŸŒ Idioma de la Sala",
        roomCode: "ğŸ”‘ CÃ³digo de Sala",
        enter: "ğŸšª ENTRAR",
        lobby: "SALA DE ESPERA",
        shareCode: "Comparte el cÃ³digo o QR Code con tus amigos",
        playersInRoom: "Jugadores en la Sala",
        waitingHost: "Esperando que el host inicie",
        leaveRoom: "SALIR DE LA SALA",
        host: "HOST",
        you: "TÃš",
        hideWord: "ğŸ™ˆ OCULTAR PALABRA",
        showWord: "ğŸ‘ï¸ MOSTRAR PALABRA",
        wordHidden: "Palabra oculta",
        startVoting: "ğŸ—³ï¸ INICIAR VOTACIÃ“N",
        voting: "ğŸ—³ï¸ VOTACIÃ“N",
        waitingVotes: "Esperando votos",
        result: "ğŸ“Š RESULTADO",
        ready: "âœ“ LISTO",
        waitingPlayers: "Esperando jugadores",
        gameOver: "ğŸ‰ FIN DEL JUEGO",
        reachedPoints: "Â¡AlcanzÃ³ la puntuaciÃ³n mÃ¡xima!",
        finalRanking: "ğŸ† RANKING FINAL",
        playAgain: "ğŸ”„ JUGAR DE NUEVO",
        minPlayers: "MÃ­nimo 3 jugadores para iniciar",
        connecting: "Conectando...",
        connected: "Conectado",
        disconnected: "Desconectado",
        roomNotFound: "Sala no encontrada",
        roomFull: "Sala llena",
        nameRequired: "Ingresa tu nombre",
        voted: "VotÃ³",
        eliminated: "Eliminado",
        surviving: "SobreviviÃ³",
        firstRoundCatch: "Atrapado en 1Âª ronda",
        pointsGained: "+{n} punto(s)",
        pointsLost: "-{n} punto(s)",
        selectCategories: "Selecciona al menos una categorÃ­a"
    }
};

let currentLang = 'pt';

function t(key) {
    return translations[currentLang][key] || translations['pt'][key] || key;
}

function applyTranslations() {
    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        const text = t(key);
        if (key === 'instructions') {
            el.innerHTML = text;
        } else {
            el.textContent = text;
        }
    });
    document.documentElement.lang = currentLang === 'pt' ? 'pt-BR' : currentLang === 'es' ? 'es' : 'en';
}

function loadLanguage() {
    const saved = localStorage.getItem('impostor_lang');
    if (saved) {
        currentLang = saved;
        return true;
    }
    return false;
}

function showSettings() {
    document.getElementById('overlay-container').innerHTML = `
        <div class="confirm-overlay" onclick="closeOverlay(event)">
            <div class="confirm-box" onclick="event.stopPropagation()">
                <h3>${t('settings')}</h3>
                <div class="section-title">${t('language')}</div>
                <div class="lang-selector" style="margin:16px 0">
                    <button class="lang-btn ${currentLang === 'pt' ? 'selected' : ''}" onclick="changeLanguage('pt')"><span class="flag">ğŸ‡§ğŸ‡·</span>PT</button>
                    <button class="lang-btn ${currentLang === 'en' ? 'selected' : ''}" onclick="changeLanguage('en')"><span class="flag">ğŸ‡ºğŸ‡¸</span>EN</button>
                    <button class="lang-btn ${currentLang === 'es' ? 'selected' : ''}" onclick="changeLanguage('es')"><span class="flag">ğŸ‡ªğŸ‡¸</span>ES</button>
                </div>
                <button class="btn btn-secondary" onclick="closeOverlay()">${t('close')}</button>
            </div>
        </div>
    `;
}

function changeLanguage(lang) {
    currentLang = lang;
    localStorage.setItem('impostor_lang', lang);
    applyTranslations();
    closeOverlay();
}
